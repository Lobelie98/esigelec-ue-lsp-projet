from pyspark import SparkContext
from pyspark.streaming import StreamingContext

import pickle

sc = SparkContext("local[2]", "Hope")
ssc = StreamingContext(sc, 5)

lines = ssc.socketTextStream("localhost",9992)
words = lines.flatMap(lambda line: line.split(" "))
pairs = words.map(lambda word: (word, 1))
counts = pairs.reduceByKey(lambda a, b: a+b)

counts.pprint()

ssc.start()
ssc.awaitTermination()
